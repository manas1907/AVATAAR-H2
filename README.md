# YOLOv8 Object Segmentation and Rotation

This repository provides a solution for segmenting and rotating objects in an image using the YOLOv8 model for segmentation and OpenCV for image manipulation. The main objective is to use YOLOv8 to segment objects and apply geometric transformations (rotation) on the detected objects according to specified angles (azimuth and polar angles).

## Features
- **Object Segmentation**: Using YOLOv8 to detect and segment objects based on a given class (e.g., "chair").
- **Object Rotation**: Applying a rotation (azimuth angle) on the segmented object and reprojecting it back onto the original image.
  
## Files

- `segment_object_yolo.py`: Segments objects using YOLOv8 and applies a color overlay on the segmented mask.
- `segment_and_rotate_object_yolo.py`: Segments objects, rotates them by the specified azimuth angle, and overlays the rotated object back onto the original image.

## Installation

1. Clone the repository:
    ```bash
    git clone https://github.com/yourusername/yolo-object-segmentation-rotation.git
    cd yolo-object-segmentation-rotation
    ```

2. Install dependencies:
    ```bash
    pip install ultralytics opencv-python numpy
    ```

3. Download the YOLOv8 model weights (`yolov8n-seg.pt`) from the [Ultralytics YOLOv8 release page](https://github.com/ultralytics/ultralytics/releases) and place it in the repository directory.

## Usage

### 1. Object Segmentation
To segment an object in an image and highlight the masked region:
```python
from segment_object_yolo import segment_object_yolo

output_path = segment_object_yolo("path_to_image.jpg", "class_name")
```
This will save an image with a red overlay on the segmented regions.

### 2. Object Segmentation and Rotation
To segment an object, rotate it by a specific angle, and overlay the rotated object back onto the image:
```python
from segment_and_rotate_object_yolo import segment_and_rotate_object_yolo

output_path = segment_and_rotate_object_yolo("path_to_image.jpg", "class_name", azimuth_angle=72, polar_angle=0)
```
This will save the rotated object onto the original image at the given azimuth angle.

### Example:
```bash
python segment_and_rotate_object_yolo.py
```

## Approach

### Problem Breakdown
1. **Segmentation**: We used YOLOv8's segmentation model (`yolov8n-seg.pt`) to identify and segment specific objects in an image based on the provided class (e.g., "chair").
   
2. **Rotation**: We leveraged OpenCV to rotate the segmented object according to an azimuth angle provided by the user. The rotation is applied around the center of the segmented object.
   
3. **Overlay**: After rotating the object, it is reprojected onto the original image, maintaining the integrity of the rest of the image.

### Experiment Results

#### Successful Outcomes
- **Segmentation**: YOLOv8 was successful in accurately segmenting the object from the image. For instance, the chair in the test image was well segmented, and its mask was appropriately extracted.
  
- **Rotation**: The rotation functionality worked well for 2D images, particularly for objects with clear boundaries like chairs and tables. The overlay was seamless when the object was rotated within small to moderate angles.

#### Failures and Issues
1. **Mask Quality**: In some cases, the masks generated by YOLOv8 were not perfect, especially for objects with complex shapes or occlusions. This resulted in rough edges when the object was rotated and reprojected back.
   
2. **Rotation Artifacts**: For larger rotation angles (e.g., >90 degrees), the rotated object did not align perfectly with the background due to perspective distortion, leading to visible artifacts around the object.

3. **Mask and Background Misalignment**: If the segmented object occupies a large portion of the image, rotating it can lead to misalignment or unnatural positioning when reprojected onto the original image.

### Analysis of Results

- **Segmentation**: The segmentation performance was mostly robust but can be improved with higher-resolution models or additional post-processing to smooth mask boundaries.
  
- **Rotation**: While the rotation for small azimuth angles worked well, larger rotations produced distortions because we applied simple 2D rotation, which doesn't account for 3D perspective changes. For 3D objects, a more sophisticated approach (like 3D rendering or depth estimation) would be needed.

### Future Improvements

1. **Better Mask Post-Processing**: Implementing mask post-processing techniques, such as contour smoothing or edge detection, could help improve the accuracy of the masks before applying rotations.

2. **3D Object Rotation**: To fully capture realistic object rotations, especially for objects like furniture, we need to consider 3D transformations. One possible improvement is to integrate depth information or use 3D modeling techniques to rotate objects more naturally.

3. **Perspective Handling**: For large rotations, incorporating perspective transformation would make the reprojected object look more realistic. This can be done by estimating the object's depth or using 3D object detection methods.

4. **Handling Complex Scenes**: In scenes with multiple overlapping objects, applying instance-aware segmentation and rotation would be beneficial. This could be achieved by extending the code to handle multiple objects and their relative positions in the scene.

## Conclusion

This project demonstrates the use of YOLOv8 for object segmentation and the application of simple 2D geometric transformations. The approach works well for basic cases but can be improved in terms of mask precision and 3D transformation handling. The current solution is effective for smaller rotations and simple objects but needs further development for more complex scenarios involving occlusions, large rotations, and 3D shapes.

## Visual Results


Input Image:

![chair](https://github.com/user-attachments/assets/772f712c-ef36-4e35-a19e-476deb195fd9)

Masked Image:

![Screenshot from 2024-10-02 23-19-20](https://github.com/user-attachments/assets/41ed9a25-38bc-456c-9122-8651a29c5d7d)

Output Image:

![Screenshot from 2024-10-02 23-19-36](https://github.com/user-attachments/assets/42f55b62-89ad-4db9-97ae-487ad271aad6)
